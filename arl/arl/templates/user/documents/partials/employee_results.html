


{% if not doc_q %}
  <div class="p-3 text-muted">Type a name or email above to find employee documents.</div>
{% else %}

  {% if employees_results %}
    <div class="accordion" id="empDocsAcc">
      {% for u in employees_results %}
        <div class="accordion-item">
          <h2 class="accordion-header" id="emp-{{ u.id }}">
   <button class="accordion-button collapsed emp-btn emp-acc-btn" type="button"
        data-bs-toggle="collapse"
        data-bs-target="#emp-collapse-{{ u.id }}"
        aria-expanded="false"
        aria-controls="emp-collapse-{{ u.id }}">

  <div class="emp-row">
    <!-- Col 1: Name + email -->
    <div class="emp-main">
      <div class="fw-semibold text-truncate">
        {{ u.get_full_name|default:u.username }}
      </div>
      <div class="text-muted small text-truncate">
        {{ u.email }}
      </div>
    </div>

    <!-- Col 2: Status (always present, fixed width) -->
    <div class="emp-status">
      <span class="badge {% if u.is_active %}bg-success{% else %}bg-secondary{% endif %}">
        {% if u.is_active %}Active{% else %}Inactive{% endif %}
      </span>
    </div>

    <!-- Col 3: Doc count (fixed width) -->
    <div class="emp-count">
      <span class="badge bg-light text-dark">{{ u.doc_count|default:0 }}</span>
    </div>
  </div>
</button>
          </h2>

          <div id="emp-collapse-{{ u.id }}"
               class="accordion-collapse collapse"
               data-bs-parent="#empDocsAcc">
            <div id="emp-body-{{ u.id }}"
                 class="accordion-body p-0"
                 hx-get="{% url 'employee_docs_panel' u.id %}"
                 hx-trigger="revealed"
                 hx-target="this"
                 hx-swap="innerHTML">
              <div class="p-3 text-muted">Loading…</div>
            </div>
          </div>

        </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="p-3 text-muted">No employees matched “{{ doc_q }}”.</div>
  {% endif %}

{% endif %}